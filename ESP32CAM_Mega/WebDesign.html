<html>
  <head>
    <meta charset="utf-8">
    <title>ROV underwater view</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body { font-family: Arial; text-align: center; margin:0px auto; padding-top: 30px;}
      table { margin-left: auto; margin-right: auto; }
      td { padding: 8 px; }
      img {  
        transform: rotate(90deg);
        width: 380px ;
        max-width: 100% ;
        height: 320px ;  
      }
      .btn-group .button {
        background-color: #669999;
        border: 1px solid white;
        color: white;
        padding: 15px 30px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
        float: left;
        width: 33.3%;
        transition-duration: 0.4s;
      }
      .btn-group2 .button2 {
        background-color: #7c9ccd;
        border: 1px solid white;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
        float: left;
        transition-duration: 0.4s;
        width: 50%;
      }
      .btn-group3 .button3 {
        background-color: #d4aa5c;
        border: 1px solid white;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
        float: left;
        transition-duration: 0.4s;
        width: 50%;
      }
      .button2:hover {
        background-color: white;
        color:#669999;
      }

      .btn-group1 .button1 {
        background-color: #669999;
        border: 1px solid white;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
        float: left;
        transition-duration: 0.4s;
        width: 100%;
      }      
      .button3:hover {
        background-color: white;
        color:#669999;
      }
      .card{
        max-width: auto;
        min-height: auto;
        background: #6175a1;
        text-align: center;
        margin: 20px auto;
        padding: 10px;
        box-sizing: border-box;
        color: #FFF;
        box-shadow: 0px 2px 18px -4px rgba(0,0,0,0.75);
      }
      .button4 {
        display: inline-block;
        background-color: #778899;
        border: none;
        color: #FFFFFF;
        text-align: center;
        font-size: 16px;
        padding: 10px;
        width: 100%;
        transition: all 0.5s;
        cursor: pointer;
        margin: 10px 0 0 0;
      }

      .button4 span {
        cursor: pointer;
        display: inline-block;
        position: relative;
        transition: 0.5s;
      }
      .button4 span:after {
        content: '\00bb';
        position: absolute;
        opacity: 0;
        top: 0;
        right: -10px;
        transition: 0.5s;
      }
      .button4:hover span {
        padding-right: 15px;
      }
      .button4:hover span:after {
        opacity: 1;
        right: 0;
      }
    </style>
    <h1 style="color:steelblue">水下機</h1>
    <h3>ROV underwater view</h3>
    <img src="" id="photo" alt="no signal"  style="transform:rotate(90deg);">
    <div class="btn-group1">
      <button class="button1 button3" onclick="toggleCheckbox('forward');">Forward</button>
    </div>
    <div class="btn-group">
      <button class="button button2" onmousedown="toggleCheckbox('left');" ontouchstart="toggleCheckbox('left');" onmouseup="toggleCheckbox('stop');" ontouchend="toggleCheckbox('stop');">Left</button>
      <button class="button button2" onmousedown="toggleCheckbox('stop');" ontouchstart="toggleCheckbox('stop');">Stop</button>
      <button class="button button2" onmousedown="toggleCheckbox('right');" ontouchstart="toggleCheckbox('right');" onmouseup="toggleCheckbox('stop');" ontouchend="toggleCheckbox('stop');">Right</button>
    </div>
    <div class="btn-group1">
      <button class="button1 button3" onmousedown="toggleCheckbox('backward');" ontouchstart="toggleCheckbox('backward');" onmouseup="toggleCheckbox('stop');" ontouchend="toggleCheckbox('stop');">Backward</button>
    </div>
    <div class="btn-group2">
      <button class="button button2" onmousedown="toggleCheckbox('rise');" ontouchstart="toggleCheckbox('rise');" onmouseup="toggleCheckbox('stop');" ontouchend="toggleCheckbox('stop');">rise</button>
      <button class="button button2" onmousedown="toggleCheckbox('dive');" ontouchstart="toggleCheckbox('dive');" onmouseup="toggleCheckbox('stop');" ontouchend="toggleCheckbox('stop');">dive</button>
    </div>
    <div class="btn-group3">
        <button class="button button3" onclick="toggleCheckbox('hand');">hand</button>
        <button class="button button3" onclick="toggleCheckbox('arm');">arm</button>
      </div>
    <button class="button4" style="vertical-align:middle" onclick="toggleCheckbox('stable');"><span>stable</span></button>
    <p style="clear:both"><br></p>
    <div class="card">
    <h2>Feedback Data</h2><br>
    <h4>Temperature : <span id="ADCValue">0</span> (degree C) </h4><br>
    <h4>Pressure : <span id="pressureValue">0</span> (Pa) </h4><br>
    </div>
   <script>
   function toggleCheckbox(x) {
     var xhr = new XMLHttpRequest();
     xhr.open("GET", "/action?go=" + x, true);
     xhr.send();
   }
   window.onload = document.getElementById("photo").src = window.location.href.slice(0, -1) + ":81/stream";

   setInterval(function() {
  // Call a function repetatively with 2 Second interval
    getTemper();
    getRSSI();
  }, 500); //500ms update rate
    
    var wifi;
    function getTemper() {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
          document.getElementById("ADCValue").innerHTML = xhttp.responseText;
        }
      };
      xhttp.open("GET", "readADC", true);
      xhttp.send();
    }
    
    function getRSSI() {
      var rssihttp = new XMLHttpRequest();
      rssihttp.onreadystatechange = function() {
        if (rssihttp.readyState == 4 && rssihttp.status == 200) {
          wifi = parseInt(rssihttp.responseText);
          console.log(wifi);  //主控台顯示wifi值
          if(wifi == 1)
          {
            alert("警告!訊號過低");
          }
        }
      };
      rssihttp.open("GET", "readRSSI", true);
      rssihttp.send();
    }

    </script>
  </body> 
</html>